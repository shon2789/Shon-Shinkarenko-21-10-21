(this["webpackJsonpweather-cloud"]=this["webpackJsonpweather-cloud"]||[]).push([[0],{105:function(e,t,a){},108:function(e,t,a){"use strict";a.r(t);var c=a(1),r=a.n(c),n=a(15),i=a.n(n),o=a(5),s=a(17),u=a(3),l=a(6),d=a.n(l),h=a(9),j=a(4),m=a(49),f=a(34),v=a(2),b=function(e){var t=e.isOpen,a=e.exitScreen;return Object(v.jsx)("div",{onClick:function(){a(!1)},className:"screen ".concat(t?"screen-active":"")})},p={saveToStorage:function(e,t){localStorage.setItem(e,JSON.stringify(t))},loadFromStorage:function(e){var t=localStorage.getItem(e);return JSON.parse(t)},removeFromStorage:function(e){localStorage.removeItem(e)}};var y={debounce:function(e){var t,a=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.75;return function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];clearTimeout(t),t=setTimeout((function(){e.apply(a,n)}),c)}},getCurrDay:function(){var e=(new Date).getDay(),t=(new Date).getDate();return{day:["SUN","MON","TUE","WED","THU","FRI","SAT"][e],date:t}},getFormattedDay:function(e){var t=new Date(1e3*e).getDay();return["SUN","MON","TUE","WED","THU","FRI","SAT"][t]},ferToCel:function(e){return(5/9*(e-32)).toFixed(1)},celToFer:function(e){return(1.8*e+32).toFixed(1)},toggleDarkMode:function(e){p.saveToStorage("isDarkMode",e)}};var O=a(122),x=a(23),g=a.n(x),w=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return x.store.addNotification({message:e,type:t,insert:"top",container:"top-right",animationIn:["animate__animated","animate__backInRight"],animationOut:["animate__animated","animate__backOutRight"],dismiss:{duration:a,onScreen:!0}})},k=function(){var e=Object(c.useState)(!1),t=Object(j.a)(e,2),a=t[0],r=t[1],n=Object(o.c)((function(e){return e.themeModule.isDarkMode})),i=Object(o.b)(),u=function(e){r(!1),i(function(e){return function(t){y.toggleDarkMode(e),t({type:"SET_THEME"})}}(e)),w("Switched to ".concat(e?"Dark":"Light"," theme"),"info",2500)};return Object(v.jsxs)("header",{className:"header main-layout",children:[Object(v.jsx)(b,{isOpen:a,exitScreen:r}),Object(v.jsx)(s.b,{to:"/",children:Object(v.jsx)("h3",{className:"".concat(n?"dark-mode":""),children:"WeatherCloud"})}),Object(v.jsxs)("nav",{className:"".concat(a?"mobile-menu-active":""," ").concat(n?"dark-mode":""," nav-container"),children:[n?a?Object(v.jsx)("h4",{onClick:function(){u(!1)},children:"Disable dark mode"}):Object(v.jsx)(O.a,{type:"button",title:"Light theme",arrow:!0,placement:"bottom",children:Object(v.jsx)("div",{className:"theme-icon-container",children:Object(v.jsx)(f.b,{className:"theme-icon",onClick:function(){u(!1)}})})}):a?Object(v.jsx)("h4",{onClick:function(){u(!0)},children:"Enable dark mode"}):Object(v.jsx)(O.a,{type:"button",title:"Dark theme",arrow:!0,placement:"bottom",children:Object(v.jsx)("div",{className:"theme-icon-container",children:Object(v.jsx)(f.a,{className:"moon-icon theme-icon",onClick:function(){u(!0)}})})}),Object(v.jsx)(s.c,{exact:!0,to:"/",children:Object(v.jsx)("div",{className:"nav-btn-container",onClick:function(){r(!1)},children:" Weather"})}),Object(v.jsx)(s.c,{to:"/favourites",children:Object(v.jsx)("div",{className:"nav-btn-container",onClick:function(){r(!1)},children:"Favourites"})})]}),Object(v.jsx)(m.a,{onClick:function(){r(!0)},className:"".concat(n?"dark-mode":""," mobile-menu-icon")})]})},C=function(e){var t=e.isCelcius,a=Object(o.c)((function(e){return e.weatherModule.currCity})),c=y.getCurrDay();return a?Object(v.jsxs)("div",{className:"today-weather",children:[Object(v.jsxs)("div",{className:"current-day",children:[Object(v.jsxs)("h3",{children:[c.day," ",c.date,","]}),Object(v.jsxs)("h3",{className:"current-city",children:["Today in ",a.cityName]})]}),Object(v.jsxs)("div",{className:"current-weather-icon",children:[Object(v.jsx)("img",{src:"https://developer.accuweather.com/sites/default/files/".concat(a.cityData.WeatherIcon<10?"0"+a.cityData.WeatherIcon:a.cityData.WeatherIcon,"-s.png"),alt:""}),Object(v.jsx)("h4",{children:a.cityData.WeatherText})]}),Object(v.jsx)("div",{className:"current-degrees",children:Object(v.jsxs)("h4",{children:[t?a.cityData.Temperature.Metric.Value:a.cityData.Temperature.Imperial.Value,"\xb0"]})})]}):Object(v.jsx)("h3",{children:"Loading.."})},D=a(21),N=a.n(D),S="cityNames",T="https://dataservice.accuweather.com/locations/v1/cities/autocomplete?apikey=".concat("GPZiCzXGLlvR80fSb8BwE1sA74LZaqk9","&q="),M={query:function(e){return F.apply(this,arguments)}};function F(){return(F=Object(h.a)(d.a.mark((function e(t){var a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=p.loadFromStorage(S)||{})[t]){e.next=4;break}if(!(Date.now()-a[t].createdAt<18e5)){e.next=4;break}return e.abrupt("return",Promise.resolve(a[t].data));case 4:return e.prev=4,e.next=7,N.a.get("".concat(T).concat(t));case 7:return c=e.sent,a[t]={createdAt:Date.now(),data:c.data.map((function(e){return{value:e.Key,label:e.LocalizedName,country:e.Country.LocalizedName}}))},p.saveToStorage(S,a),e.abrupt("return",c.data.map((function(e){return{value:e.Key,label:e.LocalizedName,country:e.Country.LocalizedName}})));case 13:e.prev=13,e.t0=e.catch(4),w("Oops! Something went wrong","danger",2e3);case 16:case"end":return e.stop()}}),e,null,[[4,13]])})))).apply(this,arguments)}var E=a(50),I=a.n(E),_=a(35),K=function(e){var t=e.onChooseCity,a=e.onToggleFavourite,r=e.isFavourite,n=e.isCelcius,i=e.setIsCelcius,s=Object(o.c)((function(e){return e.themeModule.isDarkMode})),u=Object(c.useState)(),l=Object(j.a)(u,2),m=l[0],f=l[1],b=Object(c.useRef)(),p=function(){var e=Object(h.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.target.value){e.next=12;break}return e.prev=1,e.next=4,M.query(t.target.value);case 4:return a=e.sent,f(a),e.abrupt("return");case 9:e.prev=9,e.t0=e.catch(1),w("Oops! Something went wrong","danger",2e3);case 12:f(null);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),y=Object(c.useCallback)(I()(p,300),[]),x=function(e){i(e),w("Degrees are now shown in ".concat(e?"Celcius":"Fahrenheit"),"info",2500)};return Object(v.jsxs)("section",{className:"weather-top-bar",children:[Object(v.jsxs)("form",{children:[Object(v.jsx)("input",{onBlur:function(){setTimeout((function(){f(null),b.current.value=""}),500)},ref:b,name:"searchTxt",onChange:function(e){y(e)},type:"text",placeholder:"Search city",className:"".concat(m?"on-focus":""," ").concat(s?"dark-mode":""," city-search")}),m&&Object(v.jsx)("div",{className:"".concat(s?"dark-mode":""," search-list"),children:Object(v.jsx)("ul",{children:m.map((function(e){return Object(v.jsxs)("li",{onClick:function(){!function(e){t({cityKey:e.value,cityName:e.label}),b.current.value="",f(null)}(e)},children:[e.label,", ",e.country]},e.value)}))})})]}),Object(v.jsxs)("div",{className:"top-bar-tools-container",children:[!r&&Object(v.jsx)(O.a,{type:"button",title:"Save to favourites",arrow:!0,placement:"top",children:Object(v.jsx)("div",{className:"icon-container",children:Object(v.jsx)(_.b,{onClick:a,className:"favourite-icon"})})}),r&&Object(v.jsx)(O.a,{type:"button",title:"Remove from favourites",arrow:!0,placement:"top",children:Object(v.jsx)("div",{className:"icon-container",children:Object(v.jsx)(_.a,{onClick:a,className:"favourite-icon"})})}),n&&Object(v.jsx)(O.a,{type:"button",title:"Change to fahrenheit",arrow:!0,placement:"top",children:Object(v.jsx)("h3",{onClick:function(){x(!1)},children:"C\xb0"})}),!n&&Object(v.jsx)(O.a,{type:"button",title:"Change to celcius",arrow:!0,placement:"top",children:Object(v.jsx)("h3",{onClick:function(){x(!0)},children:"F\xb0"})})]})]})},W=function(e){var t=e.currDay,a=e.isCelcius,c=Object(o.c)((function(e){return e.themeModule.isDarkMode}));return Object(v.jsxs)("div",{className:"".concat(c?"dark-mode":""," weekly-weather-preview"),children:[Object(v.jsx)("h4",{children:t.date}),Object(v.jsx)("img",{src:"https://developer.accuweather.com/sites/default/files/".concat(t.icon<10?"0"+t.icon:t.icon,"-s.png"),alt:""}),Object(v.jsxs)("h4",{children:[a?t.temperature:y.celToFer(t.temperature),"\xb0"]})]})},A=function(e){var t=e.isCelcius,a=Object(o.c)((function(e){return e.weatherModule.currCityFiveDaysDetails})),c=Object(o.c)((function(e){return e.themeModule.isDarkMode}));return Object(v.jsxs)("section",{className:"".concat(c?"dark-mode":""," weekly-weather"),children:[Object(v.jsx)("h2",{className:c?"dark-mode":"",children:"Next 5 days..."}),Object(v.jsx)("div",{className:"weekly-weather-preview-container",children:a.map((function(e){return Object(v.jsx)(W,{isCelcius:t,currDay:e},e.date)}))})]})},L=function(e){var t=e.onChooseCity,a=e.onToggleFavourite,c=e.isFavourite,r=e.setIsCelcius,n=e.isCelcius,i=Object(o.c)((function(e){return e.themeModule.isDarkMode}));return Object(v.jsxs)("div",{className:"".concat(i?"dark-mode":""," weather-content-container main-layout "),children:[Object(v.jsx)(K,{isCelcius:n,setIsCelcius:r,onChooseCity:t,onToggleFavourite:a,isFavourite:c}),Object(v.jsx)(C,{isCelcius:n}),Object(v.jsx)(A,{isCelcius:n})]})},R="cityWeather",U="cityDailyForecast",Q="favouriteCities",P="geoLocation",V="GPZiCzXGLlvR80fSb8BwE1sA74LZaqk9",z={cityCurrentWeatherQuery:function(e){return q.apply(this,arguments)},cityFiveDaysWeatherQuery:function(e){return Y.apply(this,arguments)},toggleFavourite:function(e){var t=p.loadFromStorage(Q)||{};return t[e.cityKey]?(delete t[e.cityKey],p.saveToStorage(Q,t),w("".concat(e.cityName," removed from favourites"),"info",2500),!1):(t[e.cityKey]=e.cityName,p.saveToStorage(Q,t),w("".concat(e.cityName," saved to favourites"),"success",2500),!0)},favouriteCitiesQuery:function(){return p.loadFromStorage(Q)||{}},geoLocationQuery:function(e){return B.apply(this,arguments)}};function q(){return(q=Object(h.a)(d.a.mark((function e(t){var a,c,r,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.cityKey,c=t.cityName,!(r=p.loadFromStorage(R)||{})[a]){e.next=5;break}if(!(Date.now()-r[a].createdAt<18e5)){e.next=5;break}return e.abrupt("return",Promise.resolve(r[a].data));case 5:return e.prev=5,e.next=8,N.a.get("http://dataservice.accuweather.com/currentconditions/v1/".concat(a,"?apikey=").concat(V));case 8:return n=e.sent,r[a]={data:{cityKey:a,cityName:c,cityData:n.data[0]},createdAt:Date.now()},p.saveToStorage(R,r),e.abrupt("return",r[a].data);case 14:e.prev=14,e.t0=e.catch(5),w("Oops! Something went wrong","danger",2e3);case 17:case"end":return e.stop()}}),e,null,[[5,14]])})))).apply(this,arguments)}function Y(){return(Y=Object(h.a)(d.a.mark((function e(t){var a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=p.loadFromStorage(U)||{})[t]){e.next=4;break}if(!(Date.now()-a[t].createdAt<18e5)){e.next=4;break}return e.abrupt("return",Promise.resolve(a[t].data));case 4:return e.prev=4,e.next=7,N.a.get("http://dataservice.accuweather.com/forecasts/v1/daily/5day/".concat(t,"?apikey=").concat(V));case 7:return c=e.sent,a[t]={data:c.data.DailyForecasts.map((function(e){return{date:y.getFormattedDay(e.EpochDate),temperature:y.ferToCel((e.Temperature.Minimum.Value+e.Temperature.Maximum.Value)/2),icon:e.Day.Icon}})),createdAt:Date.now()},p.saveToStorage(U,a),e.abrupt("return",a[t].data);case 13:e.prev=13,e.t0=e.catch(4),w("Oops! Something went wrong","danger",2e3);case 16:case"end":return e.stop()}}),e,null,[[4,13]])})))).apply(this,arguments)}function B(){return(B=Object(h.a)(d.a.mark((function e(t){var a,c,r,n,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.lat,c=t.lng,r=p.loadFromStorage(P)||{},!(Date.now()-r.createdAt<18e5)){e.next=4;break}return e.abrupt("return",Promise.resolve(r));case 4:return e.prev=4,e.next=7,N.a.get("http://dataservice.accuweather.com/locations/v1/cities/geoposition/search?apikey=".concat(V,"&q=").concat(a,"%2C").concat(c));case 7:return n=e.sent,i={createdAt:Date.now(),cityKey:n.data.Key,cityName:n.data.LocalizedName},p.saveToStorage(P,i),e.abrupt("return",i);case 13:e.prev=13,e.t0=e.catch(4),w("Oops! Something went wrong","danger",2e3);case 16:case"end":return e.stop()}}),e,null,[[4,13]])})))).apply(this,arguments)}var G=function(e){return function(){var t=Object(h.a)(d.a.mark((function t(a){var c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,z.cityCurrentWeatherQuery(e);case 3:return c=t.sent,a({type:"SET_CURR_CITY",cityData:c}),t.abrupt("return",c);case 8:t.prev=8,t.t0=t.catch(0),w("Oops! Something went wrong","danger",2e3);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},H=function(e){return function(){var t=Object(h.a)(d.a.mark((function t(a){var c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,z.cityFiveDaysWeatherQuery(e);case 3:return c=t.sent,a({type:"SET_CURR_CITY_FIVE_DAY",daysData:c}),t.abrupt("return",c);case 8:t.prev=8,t.t0=t.catch(0),w("Oops! Something went wrong","danger",2e3);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},J=function(){var e=Object(o.c)((function(e){return e.weatherModule.currCity})),t=Object(o.c)((function(e){return e.themeModule.isDarkMode})),a=z.favouriteCitiesQuery(),r=Object(c.useState)(),n=Object(j.a)(r,2),i=n[0],s=n[1],l=Object(c.useState)(!0),m=Object(j.a)(l,2),f=m[0],b=m[1],p=Object(o.b)(),y=Object(u.g)().cityKey,O=Object(u.f)().search;Object(c.useEffect)((function(){var t;if(y)return p(G({cityKey:y,cityName:O.split("=")[1]})),p(H(y)),void w("Current location: ".concat(O.split("=")[1]),"info",2500);e||navigator.geolocation.getCurrentPosition(function(){var e=Object(h.a)(d.a.mark((function e(a){var c,r,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=a.coords.latitude,r=a.coords.longitude,!c||!r){e.next=17;break}return e.prev=3,e.next=6,z.geoLocationQuery({lat:c,lng:r});case 6:return n=e.sent,p(G({cityKey:n.cityKey,cityName:n.cityName})),p(H(n.cityKey)),w("Showing your current location: ".concat(n.cityName),"info",2500),t&&(i=t,x.store.removeNotification(i)),e.abrupt("return");case 14:e.prev=14,e.t0=e.catch(3),w("Oops! Something went wrong","danger",2e3);case 17:case"end":return e.stop()}var i}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}()),e||(p(G({cityKey:215854,cityName:"Tel Aviv"})),p(H(215854)),t=w("Default location set to Tel Aviv","info",2500))}),[]),Object(c.useEffect)((function(){e&&e.cityKey&&s(!!a[e.cityKey])}),[e]);return Object(v.jsxs)("main",{className:"".concat(t?"dark-mode":""," weather-app"),children:[Object(v.jsx)(k,{}),Object(v.jsx)(L,{setIsCelcius:b,isCelcius:f,onChooseCity:function(e){p(G(e)),p(H(e.cityKey)),w("Showing ".concat(e.cityName,"'s weather"),"info",2500)},onToggleFavourite:function(){var t=z.toggleFavourite(e);s(t)},isFavourite:i})]})},X=function(e){var t=e.cityInfo,a=Object(c.useState)(),r=Object(j.a)(a,2),n=r[0],i=r[1],u=Object(o.c)((function(e){return e.themeModule.isDarkMode}));return Object(c.useEffect)((function(){var e=function(){var e=Object(h.a)(d.a.mark((function e(){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,z.cityCurrentWeatherQuery({cityKey:t[0],cityName:t[1]});case 3:a=e.sent,i(a),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),w("Oops! Something went wrong","danger",2e3);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[t]),n?Object(v.jsx)(s.b,{to:"/".concat(t[0],"?name=").concat(t[1]),children:Object(v.jsxs)("div",{className:"".concat(u?"dark-mode":""," favourites-preview"),children:[Object(v.jsx)("h2",{className:"favourites-preview-name",children:n.cityName}),Object(v.jsxs)("h4",{className:"favourites-preview-temp",children:[n.cityData.Temperature.Metric.Value,"\xb0"]}),Object(v.jsx)("img",{src:"https://developer.accuweather.com/sites/default/files/".concat(n.cityData.WeatherIcon<10?"0"+n.cityData.WeatherIcon:n.cityData.WeatherIcon,"-s.png"),alt:""}),Object(v.jsx)("h4",{className:"favourites-preview-text",children:n.cityData.WeatherText})]})}):Object(v.jsx)("h1",{children:"Loading..."})},Z=function(){var e=Object(o.c)((function(e){return e.themeModule.isDarkMode})),t=Object(c.useState)(),a=Object(j.a)(t,2),r=a[0],n=a[1];return Object(c.useEffect)((function(){var e=z.favouriteCitiesQuery();n(Object.entries(e))}),[]),Object(v.jsxs)("div",{className:"".concat(e?"dark-mode":""," favourite-list main-layout"),children:[(0===(null===r||void 0===r?void 0:r.length)||!r)&&Object(v.jsx)("h2",{className:"favourites-title",children:"No favourite cities to show"}),r&&r.map((function(e){return Object(v.jsx)(X,{cityInfo:e},e[0])}))]})},$=function(){var e=Object(o.c)((function(e){return e.themeModule.isDarkMode}));return Object(v.jsxs)("div",{className:"".concat(e?"dark-mode":""," favourites-container"),children:[Object(v.jsx)(k,{}),Object(v.jsx)(Z,{})]})},ee=function(){return Object(v.jsx)(s.a,{children:Object(v.jsxs)(u.c,{children:[Object(v.jsx)(u.a,{exact:!0,path:"/favourites",component:$}),Object(v.jsx)(u.a,{exact:!0,path:"/:cityKey",component:J}),Object(v.jsx)(u.a,{exact:!0,path:"/",component:J})]})})},te=a(25),ae=a(51),ce={isDarkMode:p.loadFromStorage("isDarkMode")||!0},re=a(18),ne={currCity:null,currCityFiveDaysDetails:[]},ie=Object(te.b)({weatherModule:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURR_CITY":return Object(re.a)(Object(re.a)({},e),{},{currCity:t.cityData});case"SET_CURR_CITY_FIVE_DAY":return Object(re.a)(Object(re.a)({},e),{},{currCityFiveDaysDetails:t.daysData});default:return e}},themeModule:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=arguments.length>1?arguments[1]:void 0;return"SET_THEME"===t.type?{isDarkMode:!e.isDarkMode}:e}}),oe=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||te.c,se=Object(te.d)(ie,oe(Object(te.a)(ae.a)));a(105),a(106),a(107);i.a.render(Object(v.jsx)(r.a.StrictMode,{children:Object(v.jsxs)(o.a,{store:se,children:[Object(v.jsx)(g.a,{}),Object(v.jsx)(ee,{})]})}),document.getElementById("root"))}},[[108,1,2]]]);
//# sourceMappingURL=main.e0ae4a46.chunk.js.map